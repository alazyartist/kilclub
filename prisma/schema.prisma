// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "mysql"
    url      = env("DATABASE_URL")
    relationMode = "prisma"
}

model User {
    user_id        String   @id @unique @default(cuid())
    stripe_customer_id  String? @unique
    subscription_tier  String?
    subscription_id  String?
    subscription_status  String?
    isBusiness  Boolean?
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
    business_id String? @unique
    Business BusinessInfo[]
    Jobs Jobs[] @relation("Jobs")
    Reviews Jobs[] @relation("Reviews")
}

model BusinessInfo{
    business_id String @id @unique @default(cuid())
    User User? @relation(fields: [business_id],references: [business_id])
    business_name String
    website String?
    phone_number String
    zip_code String
    Jobs Jobs[]
    createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
@@index([business_id])
}

model Jobs{
    job_id String @id @unique
    business_id String 
    customer_phone_number String
    zip_code String
    date DateTime @default(now())
    reviewer_id String?
    isCompleted Boolean? @default(false)
    isReviewed Boolean? @default(false)
    User User @relation("Jobs",references: [business_id],fields: [business_id],map: "user")
    Reviewer User? @relation("Reviews",fields: [reviewer_id],references: [user_id],map:"reviewer")
    Business BusinessInfo @relation(references: [business_id],fields: [business_id],map: "business")
    review String? @db.Text()
    media Json?
    problem_solved Boolean?
     createdAt DateTime @default(now())
    updatedAt DateTime @updatedAt
@@index([business_id])
@@index([reviewer_id])
}